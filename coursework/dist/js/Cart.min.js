class Cart{constructor(t="#cart"){this.container=t,this.countGoods=0,this.amount=0,this.cartItems=[],this._init(this.source)}_render(){let t=$("<button/>",{class:"cart-close",text:"Закрыть корзину"}),a=$("<a/>",{class:"cart-btn",href:"shoppingCart.html",text:"Оформить заказ"}),s=$("<div/>",{class:"cart-wrapper-btn"}),e=$("<div/>",{class:"cart-items-wrap"}),i=$("<div/>",{class:"cart-summary sum-amount"}),r=$("<div/>",{class:"cart-summary sum-price"});$(this.container).append("<p>Корзина</p>"),t.appendTo(s),a.appendTo(s),s.appendTo($(this.container)),e.appendTo($(this.container)),i.appendTo($(this.container)),r.appendTo($(this.container))}_renderItem(t){let a=$("<div/>",{class:"cart-item","data-product":t.id_product}),s=$('<button class="del-btn">&times;</button>'),e=$("<div/>",{class:"product-text-wrapper"});a.append($(`<img class="product-img" src="${t.img}">`)),e.append($(`<p class="product-name">${t.product_name}</p>`)),e.append($(`<p class="product-quantity">${t.quantity} шт</p>`)),e.append($(`<p class="product-price">${t.price} $</p>`)),a.append(e),a.append(s),s.click(()=>{this._remove(t.id_product)}),$(".cart-items-wrap").append(a)}_renderSum(t,a){$(".sum-amount").text(`Всего товаров в корзине: ${a}`),$(".sum-price").text(`Общая сумма: $${t}.`)}_init(){if(this._render(),localStorage.getItem("mycart")){this.cartItems=JSON.parse(localStorage.getItem("mycart"));for(let t of this.cartItems)this._renderItem(t),this.countGoods+=t.quantity,this.amount+=t.price*t.quantity,this._renderSum(this.amount,this.countGoods)}else this._renderSum(0,0)}_updateCart(t){let a=$(`div[data-product="${t.id_product}"]`);a.find(".product-quantity").text(t.quantity),a.find(".product-price").text(`${t.quantity*t.price} $.`),a.find(".shCart-col-quantity").html(`<span>${t.quantity}</span>`),a.find(".shCart-col-subtotal").html(`<span>${t.quantity*t.price} $.</span>`)}_addProduct(t){let a=+$(t).data("id"),s=this.cartItems.find(t=>t.id_product===a);if(s)s.quantity++,this.countGoods++,this.amount+=s.price,this._updateCart(s);else{let s={id_product:a,price:+$(t).data("price"),product_name:$(t).data("name"),quantity:1,img:$(t).data("img")};this.cartItems.push(s),this.amount+=s.price,this.countGoods+=s.quantity,this._renderItem(s)}localStorage.setItem("mycart",JSON.stringify(this.cartItems)),this._renderSum(this.amount,this.countGoods)}_remove(t){let a=this.cartItems.find(a=>a.id_product===t);if(a.quantity>1)a.quantity--,this._updateCart(a);else{let s=$(`div[data-product="${t}"]`);this.cartItems.splice(this.cartItems.indexOf(a),1),s.remove()}this.countGoods--,0==this.countGoods?$(".cart-num").css("display","none"):$(".cart-num").css("display","block").text(this.countGoods),this.amount-=a.price,localStorage.setItem("mycart",JSON.stringify(this.cartItems)),this._renderSum(this.amount,this.countGoods)}_renderShCart(){this.cartItems=JSON.parse(localStorage.getItem("mycart"));for(let t of this.cartItems){let a=$("<div/>",{class:"shCart-item","data-product":t.id_product}),s=$("<div/>",{class:"shCart-col-product"}),e=$("<div/>",{class:"shCart-product-description"}),i=$("<div/>",{class:"shCart-col-price"}),r=$("<div/>",{class:"shCart-col-quantity"}),p=$("<div/>",{class:"shCart-col-shipping"}),c=$("<div/>",{class:"shCart-col-subtotal"}),n=$("<div/>",{class:"shCart-col-action"}),d=$('<button class="del-btn shCart-item-del-btn">&times;</button>'),o=t.price*t.quantity;s.append($(`<img src="${t.img}">`)),s.append(e),e.append($(`<p class="shCart-product-title">${t.product_name}</p>`)),e.append($('<p class="shCart-product-text__color">color:<span>red</span></p>')),e.append($('<p class="shCart-product-text__color">size:<span>xll</span></p>')),i.append($(`<span>${t.price} $</span>`)),r.append($(`<span>${t.quantity}</span>`)),p.append($("<span>free</span>")),c.append($(`<span>${o} $</span>`)),n.append(d),a.append(s),a.append(i),a.append(r),a.append(p),a.append(c),a.append(n),$(".shCart-wrapper-items").append(a),d.click(()=>{this._remove(t.id_product)})}}}