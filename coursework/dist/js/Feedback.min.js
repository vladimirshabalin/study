class Feedback{constructor(t,e="#feedback",s="#myform"){this.source=t,this.container=e,this.form=s,this.comments=[],this.curID=0,this._init(this.source)}_init(t){fetch(t).then(t=>t.json()).then(t=>{this.curID=t.maxID;for(let e of t.comments)this.comments.push(e),this._renderComment(e);this._initForm()})}_initForm(){$(this.form).submit(t=>{if(t.preventDefault(),!$("#author").val()&&!$("#text").val())return;let e={id:++this.curID,author:$("#author").val(),text:$("#text").val(),approved:!1};this.comments.push(e),this._renderComment(e)})}_renderComment(t){let e=$("<div/>",{class:"comment","data-id":t.id}),s=$(`<h3 class="author">${t.author}</h3>`),o=$(`<p class="text">${t.text}</p>`),i=$('<button class="remove-btn">Удалить</button>');if(e.append(s),e.append(o),e.append(i),i.click(()=>{this._remove(t.id)}),t.approved)e.addClass("approved");else{let s=$('<button class="approve-btn">Одобрить</button>');e.append(s),e.addClass("not-approved"),s.click(()=>{this._approve(t.id)})}$(this.container).append(e)}_remove(t){let e=this.comments.find(e=>e.id===t);this.comments.splice(this.comments.indexOf(e),1),$(`.comment[data-id="${t}"]`).remove()}_approve(t){let e=this.comments.find(e=>e.id===t);$(`.comment[data-id="${t}"]`).removeClass("not-approved").addClass("approved").find(".approve-btn").remove(),e.approved=!0}}